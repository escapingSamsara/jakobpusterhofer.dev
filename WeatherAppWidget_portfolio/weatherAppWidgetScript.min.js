window.addEventListener("load",function(){let e={apiKey:config.WEATHER_API_KEY,fetchWeather:function(e){fetch(`https://api.openweathermap.org/data/2.5/weather?q=${e}&units=metric&lang=en&appid=${this.apiKey}`).then(e=>e.json()).then(e=>this.displayWeather(e))},displayWeather:function(e){const{name:t}=e,{icon:o,description:n}=e.weather[0],{temp:r,humidity:c}=e.main,{speed:a}=e.wind;document.querySelector(".city").innerText=`Weather in ${t}`,document.querySelector(".icon").src=`https://openweathermap.org/img/wn/${o}@2x.png`,document.querySelector(".temp").innerText=`${Math.floor(r)}Â°C`,document.querySelector(".description").innerText=`${n}`,document.querySelector(".humidity").innerText=`${c} %`,document.querySelector(".speed").innerText=`${a} km/h`,document.querySelector(".weather").classList.remove("loading"),document.querySelector(".card").style.backgroundImage=`linear-gradient(\n      180deg,\n      rgba(0, 0, 0, 0.75) 0%,\n      rgba(0,0 ,0 ,0.7) 50%,\n      rgba(0, 0, 0, 0.75) 100%\n    ), url(https://source.unsplash.com/featured/?${t})`},search:function(){this.fetchWeather(document.querySelector(".search-bar").value)}},t={reverseGeocode:function(t,o){let n=config.GEOCODE_API_KEY,r="https://api.opencagedata.com/geocode/v1/json",c=r+"?key="+n+"&q="+encodeURIComponent(t+","+o)+"&pretty=1&no_annotations=1",a=new XMLHttpRequest;a.open("GET",c,!0),a.onload=function(){if(200===a.status){let t=JSON.parse(a.responseText);e.fetchWeather(t.results[0].components.city)}else if(a.status<=500){console.log("unable to geocode! Response code: "+a.status);let e=JSON.parse(a.responseText);console.log("error msg: "+e.status.message)}else console.log("server error")},a.onerror=function(){console.log("unable to connect to server")},a.send()},getLocation:function(){function o(e){t.reverseGeocode(e.coords.latitude,e.coords.longitude)}navigator.geolocation?navigator.geolocation.getCurrentPosition(o,console.error):e.fetchWeather("Graz")}};document.querySelector(".search-btn").addEventListener("click",function(){e.search()}),document.querySelector(".search-bar").addEventListener("keyup",function(t){"Enter"==t.key&&e.search()}),t.getLocation()});